<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The bldfm package &#8212; BLDFM 1.0.0-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=89e598d8" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=56c4699f" />
    <script src="_static/documentation_options.js?v=8313637b"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example scripts and workflows" href="runs.html" />
    <link rel="prev" title="Package overview" href="overview.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo" />
    
    <h1 class="logo logo-name">BLDFM</h1>
    
  </a>
</p>



<p class="blurb">A Python dispersion and footprint model</p>






<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_quickstart.html">Quickstart tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_full.html">Full tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Quick reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Package overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#core-modules">Core modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-and-interface">Configuration and interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-and-i-o">Data and I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SchlutowSM2Group/BLDFM">GitHub repository</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="runs.html">Example scripts and workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">The <code class="docutils literal notranslate"><span class="pre">tests</span></code> subpackage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Glossary Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="py-modindex.html">Module Index</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="overview.html" title="previous chapter">Package overview</a></li>
      <li>Next: <a href="runs.html" title="next chapter">Example scripts and workflows</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="overview.html" title="Previous document">Package overview</a>
        </li>
        <li>
          <a href="runs.html" title="Next document">Example scripts and workflows</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="the-bldfm-package">
<span id="src"></span><h1>The <code class="docutils literal notranslate"><span class="pre">bldfm</span></code> package<a class="headerlink" href="#the-bldfm-package" title="Link to this heading">¶</a></h1>
<p>This package contains the BLDFM model. It includes core modules for the PBL model, spectral solver, and utility functions, as well as higher-level modules for configuration, interface, I/O, caching, plotting, and synthetic data generation.</p>
<section id="core-modules">
<h2>Core modules<a class="headerlink" href="#core-modules" title="Link to this heading">¶</a></h2>
<section id="module-bldfm.pbl_model">
<span id="bldfm-pbl-model-module"></span><h3>bldfm.pbl_model module<a class="headerlink" href="#module-bldfm.pbl_model" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.pbl_model.phi">
<span class="sig-prename descclassname"><span class="pre">bldfm.pbl_model.</span></span><span class="sig-name descname"><span class="pre">phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/pbl_model.html#phi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.pbl_model.phi" title="Link to this definition">¶</a></dt>
<dd><p>Stability correction function for eddy diffusivity in Monin-Obukhov Similarity Theory (MOST).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – Dimensionless stability parameter (z / mol).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stability correction factor for eddy diffusivity.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For stable conditions (x &gt; 0), a linear relationship is used.</p></li>
<li><p>For unstable conditions (x &lt; 0), the Businger-Dyer formulation is applied.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.pbl_model.psi">
<span class="sig-prename descclassname"><span class="pre">bldfm.pbl_model.</span></span><span class="sig-name descname"><span class="pre">psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/pbl_model.html#psi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.pbl_model.psi" title="Link to this definition">¶</a></dt>
<dd><p>Stability correction function for Monin-Obukhov Similarity Theory (MOST).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – Dimensionless stability parameter (z / mol).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stability correction factor for momentum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For stable conditions (x &gt; 0), a linear relationship is used.</p></li>
<li><p>For unstable conditions (x &lt; 0), the Businger-Dyer formulation is applied.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.pbl_model.vertical_profiles">
<span class="sig-prename descclassname"><span class="pre">bldfm.pbl_model.</span></span><span class="sig-name descname"><span class="pre">vertical_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ustar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prsc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MOST'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tke</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/pbl_model.html#vertical_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.pbl_model.vertical_profiles" title="Link to this definition">¶</a></dt>
<dd><p>Computes vertical profiles of horizontal wind components and eddy diffusivity in the planetary boundary layer (PBL) based on Monin-Obukhov Similarity Theory (MOST) or other closure models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of vertical grid points between z0 and meas_height.</p></li>
<li><p><strong>meas_height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Measurement height above the ground.</p></li>
<li><p><strong>wind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>floats</em>) – Zonal (u) and meridional (v) wind components at the measurement height.</p></li>
<li><p><strong>ustar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – Friction velocity [m/s].</p></li>
<li><p><strong>mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Monin-Obukhov length. Default is 1e9 (neutral conditions).</p></li>
<li><p><strong>prsc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Prandtl or Schmidt number. Default is 1.0.</p></li>
<li><p><strong>closure</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Closure model to use. Options are “MOST”, “CONSTANT”, or “OAAHOC”. Default is “MOST”.</p></li>
<li><p><strong>z0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Roughness length. Default is -1e9 (auto-calculated).</p></li>
<li><p><strong>z0_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum allowable roughness length. Default is 0.001.</p></li>
<li><p><strong>z0_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum allowable roughness length. Default is 2.0.</p></li>
<li><p><strong>tke</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Turbulent kinetic energy [m²/s²] for the “OAAHOC” closure. If not provided, it will default to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>z (numpy.ndarray): 1D array of vertical grid points.</p></li>
<li><p>profiles (tuple of numpy.ndarray): 1D arrays of horizontal wind components (u, v)
and eddy diffusivities (Kx, Ky, Kz) at each vertical grid point.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If invalid closure type is provided.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The “OAAHOC” closure uses a one-and-a-half order closure model based on Schumann-Lilly.</p></li>
<li><p>The “MOST” closure uses Monin-Obukhov Similarity Theory.</p></li>
</ul>
<p class="rubric">References</p>
<ul class="simple">
<li><p>Kormann, R., &amp; Meixner, F. X. (2001). An analytical footprint model for non-neutral stratification. Boundary-Layer Meteorology, 99(2), 207–224. <a class="reference external" href="https://doi.org/10.1023/A:1018991015119">https://doi.org/10.1023/A:1018991015119</a></p></li>
<li><p>Schumann, U. (1991). Subgrid length-scales for large-eddy simulation of stratified turbulence. Theoretical and Computational Fluid Dynamics, 2(5), 279–290. <a class="reference external" href="https://doi.org/10.1007/BF00271468">https://doi.org/10.1007/BF00271468</a></p></li>
</ul>
</dd></dl>

</section>
<section id="module-bldfm.solver">
<span id="bldfm-solver-module"></span><h3>bldfm.solver module<a class="headerlink" href="#module-bldfm.solver" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.solver.steady_state_transport_solver">
<span class="sig-prename descclassname"><span class="pre">bldfm.solver.</span></span><span class="sig-name descname"><span class="pre">steady_state_transport_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">srf_flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(512,</span> <span class="pre">512)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srf_bg_conc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">footprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/solver.html#steady_state_transport_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.solver.steady_state_transport_solver" title="Link to this definition">¶</a></dt>
<dd><p>Solves the steady-state advection-diffusion equation for a concentration
with flux boundary condition given vertical profiles of wind and eddy diffusivity
using the Fourier, linear shooting, and semi-implicit Euler methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srf_flx</strong> (<em>ndarray</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – 2D field of surface kinematic flux at z=z0 [m/s].</p></li>
<li><p><strong>z</strong> (<em>ndarray</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – 1D array of vertical grid points from z0 to zm [m].</p></li>
<li><p><strong>profiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>ndarray</em>) – Tuple containing 1D arrays of vertical profiles of zonal wind, meridional wind [m/s],
and eddy diffusivities [m²/s].</p></li>
<li><p><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Tuple containing domain sizes (xmax, ymax) [m].</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Vertical level for output or optionally 1D array of output levels.</p></li>
<li><p><strong>modes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Tuple containing the number of zonal and meridional Fourier modes (nlx, nly).
Default is (512, 512).</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Coordinates of the measurement point (xm, ym) [m] relative to <cite>srf_flx</cite>,
where the origin is at <cite>srf_flx[0, 0]</cite>. Default is (0.0, 0.0).</p></li>
<li><p><strong>srf_bg_conc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Surface background concentration at z=z0 [scalar_unit]. Default is 0.0.</p></li>
<li><p><strong>footprint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, activates footprints (Green’s function) for output. Default is False.</p></li>
<li><p><strong>analytic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, uses the analytic solution for constant wind and eddy diffusivity.
Default is False.</p></li>
<li><p><strong>halo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Width of the zero-flux halo around the domain [m]. Default is -1e9, which sets
the halo to <cite>max(xmax, ymax)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z</strong> (<em>ndarray of float</em>) – Heights [m] at levels.</p></li>
<li><p><strong>conc</strong> (<em>ndarray of float</em>) – 2D or 3D field of concentration at levels or Green’s function.</p></li>
<li><p><strong>flx</strong> (<em>ndarray of float</em>) – 2D or 3D field of kinematic flux at levels or footprint.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.utils">
<span id="bldfm-utils-module"></span><h3>bldfm.utils module<a class="headerlink" href="#module-bldfm.utils" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.compute_wind_fields">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">compute_wind_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#compute_wind_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.compute_wind_fields" title="Link to this definition">¶</a></dt>
<dd><p>Computes the zonal (u) and meridional (v) wind components from a rotated
wind speed and direction using the meteorological convention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_rot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Rotated wind speed.</p></li>
<li><p><strong>wind_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wind direction in degrees (meteorological convention:
direction the wind is coming FROM, clockwise from north).
0 = from north, 90 = from east, 180 = from south, 270 = from west.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple (u, v) where:</dt><dd><ul class="simple">
<li><p>u (float): Zonal wind component (east-west, positive = eastward).</p></li>
<li><p>v (float): Meridional wind component (north-south, positive = northward).</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.get_logger">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.get_logger" title="Link to this definition">¶</a></dt>
<dd><p>Get a logger instance for the given module.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.get_source_area">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">get_source_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#get_source_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.get_source_area" title="Link to this definition">¶</a></dt>
<dd><p>Rescale g so contour levels represent cumulative contribution of f.</p>
<p>For the transformed field, the contour at level R encloses the region
where sum(f) = R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Function values (e.g., flux footprint).</p></li>
<li><p><strong>g</strong> (<em>ndarray</em>) – Function defining level sets (often same as f).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g_rescaled</strong> – Transformed field where contour values equal cumulative contribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.ideal_source">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">ideal_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'diamond'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#ideal_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.ideal_source" title="Link to this definition">¶</a></dt>
<dd><p>Creates a synthetic source field in the shape of a circle or diamond.
Useful for testing purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nxy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Number of grid points in the x and y directions (nx, ny).</p></li>
<li><p><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Physical dimensions of the domain (xmax, ymax).</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Shape of the source field. Options are “circle” or “diamond”. Default is “diamond”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array representing the source field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.parallelize">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">parallelize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#parallelize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.parallelize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.point_measurement">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">point_measurement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#point_measurement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.point_measurement" title="Link to this definition">¶</a></dt>
<dd><p>Computes the convolution of two 2D arrays evaluated at a specific point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – First 2D array.</p></li>
<li><p><strong>g</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><em>numpy.ndarray</em></a>) – Second 2D array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the convolution at the specified point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.setup_logging">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">setup_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#setup_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.setup_logging" title="Link to this definition">¶</a></dt>
<dd><p>Set up logging configuration with customizable options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)</p></li>
<li><p><strong>format_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Custom format string for log messages</p></li>
<li><p><strong>log_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Optional specific log file name (overrides auto_file)</p></li>
<li><p><strong>log_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory to store log files</p></li>
<li><p><strong>auto_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, automatically generate timestamped filename</p></li>
<li><p><strong>run_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Optional run name to include in log filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.source_area_circular">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">source_area_circular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#source_area_circular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.source_area_circular" title="Link to this definition">¶</a></dt>
<dd><p>Base function for circular contours centered at measurement point.</p>
<p>g = -(r^2), so contours are concentric circles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xm</em><em>, </em><em>ym</em><em>)</em>) – Measurement (tower) location.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (ny, nx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.source_area_contribution">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">source_area_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#source_area_contribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.source_area_contribution" title="Link to this definition">¶</a></dt>
<dd><p>Base function for contribution (isopleth) contours: g = flx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (ny, nx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.source_area_crosswind">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">source_area_crosswind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#source_area_crosswind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.source_area_crosswind" title="Link to this definition">¶</a></dt>
<dd><p>Base function for crosswind ridge contours.</p>
<p>g = -(perpendicular distance from wind axis)^2.
Contours are symmetric ridges parallel to the wind direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xm</em><em>, </em><em>ym</em><em>)</em>) – Measurement (tower) location.</p></li>
<li><p><strong>wind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>u</em><em>, </em><em>v</em><em>)</em>) – Wind components (m/s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (ny, nx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.source_area_sector">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">source_area_sector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#source_area_sector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.source_area_sector" title="Link to this definition">¶</a></dt>
<dd><p>Base function for angular sector contours from upwind axis.</p>
<p>g = -abs(theta), where theta is angular deviation from upwind direction.
Contours form pie-slice sectors centered on the upwind direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xm</em><em>, </em><em>ym</em><em>)</em>) – Measurement (tower) location.</p></li>
<li><p><strong>wind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>u</em><em>, </em><em>v</em><em>)</em>) – Wind components (m/s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (ny, nx)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.utils.source_area_upwind">
<span class="sig-prename descclassname"><span class="pre">bldfm.utils.</span></span><span class="sig-name descname"><span class="pre">source_area_upwind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/utils.html#source_area_upwind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.utils.source_area_upwind" title="Link to this definition">¶</a></dt>
<dd><p>Base function for upwind distance-band contours.</p>
<p>g = dot(wind_hat, r), where r is displacement from tower.
Contours are lines perpendicular to the wind direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Coordinate grids.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xm</em><em>, </em><em>ym</em><em>)</em>) – Measurement (tower) location.</p></li>
<li><p><strong>wind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>u</em><em>, </em><em>v</em><em>)</em>) – Wind components (m/s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (ny, nx)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.fft_manager">
<span id="bldfm-fft-manager-module"></span><h3>bldfm.fft_manager module<a class="headerlink" href="#module-bldfm.fft_manager" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="bldfm.fft_manager.FFTManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.fft_manager.</span></span><span class="sig-name descname"><span class="pre">FFTManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wisdom_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fftw_wisdom.pkl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_keepalive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#FFTManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.FFTManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Manages pyFFTW with wisdom and caching for optimal performance in Dask environments.</p>
<p>This class addresses memory issues in Dask parallelized environments by:
- Using pyfftw numpy interface for compatibility
- Loading/saving FFTW wisdom for optimal planning
- Enabling pyfftw caching to prevent repeated object allocation
- Providing proper memory management and cleanup</p>
<dl class="py method">
<dt class="sig sig-object py" id="bldfm.fft_manager.FFTManager.clear_cache">
<span class="sig-name descname"><span class="pre">clear_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#FFTManager.clear_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.FFTManager.clear_cache" title="Link to this definition">¶</a></dt>
<dd><p>Clear pyfftw cache.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bldfm.fft_manager.FFTManager.fft2">
<span class="sig-name descname"><span class="pre">fft2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'backward'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#FFTManager.fft2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.FFTManager.fft2" title="Link to this definition">¶</a></dt>
<dd><p>Perform 2D forward FFT using pyfftw numpy interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> – Input array for FFT</p></li>
<li><p><strong>norm</strong> – Normalization mode (“forward”, “backward”, “ortho”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Complex array with FFT result</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bldfm.fft_manager.FFTManager.ifft2">
<span class="sig-name descname"><span class="pre">ifft2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'backward'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#FFTManager.ifft2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.FFTManager.ifft2" title="Link to this definition">¶</a></dt>
<dd><p>Perform 2D inverse FFT using pyfftw numpy interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data</strong> – Input array for inverse FFT</p></li>
<li><p><strong>norm</strong> – Normalization mode (“forward”, “backward”, “ortho”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Complex array with inverse FFT result</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.fft_manager.fft2">
<span class="sig-prename descclassname"><span class="pre">bldfm.fft_manager.</span></span><span class="sig-name descname"><span class="pre">fft2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'backward'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#fft2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.fft2" title="Link to this definition">¶</a></dt>
<dd><p>Global function for 2D FFT using the FFT manager.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.fft_manager.get_fft_manager">
<span class="sig-prename descclassname"><span class="pre">bldfm.fft_manager.</span></span><span class="sig-name descname"><span class="pre">get_fft_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_keepalive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#get_fft_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.get_fft_manager" title="Link to this definition">¶</a></dt>
<dd><p>Get or create the global FFT manager instance.</p>
<p>If the manager already exists with different num_threads, it is
re-initialised with the new thread count.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.fft_manager.ifft2">
<span class="sig-prename descclassname"><span class="pre">bldfm.fft_manager.</span></span><span class="sig-name descname"><span class="pre">ifft2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'backward'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#ifft2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.ifft2" title="Link to this definition">¶</a></dt>
<dd><p>Global function for 2D inverse FFT using the FFT manager.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.fft_manager.reset_fft_manager">
<span class="sig-prename descclassname"><span class="pre">bldfm.fft_manager.</span></span><span class="sig-name descname"><span class="pre">reset_fft_manager</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/fft_manager.html#reset_fft_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.fft_manager.reset_fft_manager" title="Link to this definition">¶</a></dt>
<dd><p>Reset FFTManager singleton (call in forked worker processes).</p>
</dd></dl>

</section>
</section>
<section id="configuration-and-interface">
<h2>Configuration and interface<a class="headerlink" href="#configuration-and-interface" title="Link to this heading">¶</a></h2>
<section id="module-bldfm.config_parser">
<span id="bldfm-config-parser-module"></span><h3>bldfm.config_parser module<a class="headerlink" href="#module-bldfm.config_parser" title="Link to this heading">¶</a></h3>
<p>YAML configuration parser and dataclass schema for BLDFM.</p>
<dl class="simple">
<dt>Defines the configuration hierarchy:</dt><dd><p>BLDFMConfig
├── DomainConfig
├── List[TowerConfig]
├── MetConfig
├── SolverConfig
├── OutputConfig
└── ParallelConfig</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">BLDFMConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">domain:</span> <span class="pre">~bldfm.config_parser.DomainConfig,</span> <span class="pre">towers:</span> <span class="pre">~typing.List[~bldfm.config_parser.TowerConfig],</span> <span class="pre">met:</span> <span class="pre">~bldfm.config_parser.MetConfig,</span> <span class="pre">solver:</span> <span class="pre">~bldfm.config_parser.SolverConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">output:</span> <span class="pre">~bldfm.config_parser.OutputConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">parallel:</span> <span class="pre">~bldfm.config_parser.ParallelConfig</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#BLDFMConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Top-level BLDFM configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig.domain">
<span class="sig-name descname"><span class="pre">domain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#bldfm.config_parser.DomainConfig" title="bldfm.config_parser.DomainConfig"><span class="pre">DomainConfig</span></a></em><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig.domain" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig.met">
<span class="sig-name descname"><span class="pre">met</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#bldfm.config_parser.MetConfig" title="bldfm.config_parser.MetConfig"><span class="pre">MetConfig</span></a></em><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig.met" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig.output">
<span class="sig-name descname"><span class="pre">output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#bldfm.config_parser.OutputConfig" title="bldfm.config_parser.OutputConfig"><span class="pre">OutputConfig</span></a></em><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig.output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig.parallel">
<span class="sig-name descname"><span class="pre">parallel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#bldfm.config_parser.ParallelConfig" title="bldfm.config_parser.ParallelConfig"><span class="pre">ParallelConfig</span></a></em><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig.parallel" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig.solver">
<span class="sig-name descname"><span class="pre">solver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#bldfm.config_parser.SolverConfig" title="bldfm.config_parser.SolverConfig"><span class="pre">SolverConfig</span></a></em><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig.solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.BLDFMConfig.towers">
<span class="sig-name descname"><span class="pre">towers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><span class="pre">TowerConfig</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#bldfm.config_parser.BLDFMConfig.towers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">DomainConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(512,</span> <span class="pre">512)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#DomainConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.DomainConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Configuration for the computational domain.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.full_output">
<span class="sig-name descname"><span class="pre">full_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.full_output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.halo">
<span class="sig-name descname"><span class="pre">halo</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.halo" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.modes">
<span class="sig-name descname"><span class="pre">modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(512,</span> <span class="pre">512)</span></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.nx">
<span class="sig-name descname"><span class="pre">nx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.nx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.ny">
<span class="sig-name descname"><span class="pre">ny</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.ny" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.nz">
<span class="sig-name descname"><span class="pre">nz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.nz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.output_levels">
<span class="sig-name descname"><span class="pre">output_levels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.output_levels" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.ref_lat">
<span class="sig-name descname"><span class="pre">ref_lat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.ref_lat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.ref_lon">
<span class="sig-name descname"><span class="pre">ref_lon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.ref_lon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.xmax">
<span class="sig-name descname"><span class="pre">xmax</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.xmax" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.DomainConfig.ymax">
<span class="sig-name descname"><span class="pre">ymax</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#bldfm.config_parser.DomainConfig.ymax" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">MetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ustar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">270.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#MetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.MetConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Meteorological forcing data (scalar for single-time, list for timeseries).</p>
<dl class="py method">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.get_step">
<span class="sig-name descname"><span class="pre">get_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/bldfm/config_parser.html#MetConfig.get_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.MetConfig.get_step" title="Link to this definition">¶</a></dt>
<dd><p>Get met parameters for a single timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with scalar values for ustar, mol, wind_speed, wind_dir, timestamp.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.mol">
<span class="sig-name descname"><span class="pre">mol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000000000.0</span></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.mol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.n_timesteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_timesteps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.n_timesteps" title="Link to this definition">¶</a></dt>
<dd><p>Number of timesteps in the timeseries.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.timestamps">
<span class="sig-name descname"><span class="pre">timestamps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.timestamps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.ustar">
<span class="sig-name descname"><span class="pre">ustar</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.ustar" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#MetConfig.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.MetConfig.validate" title="Link to this definition">¶</a></dt>
<dd><p>Validate that at least one of ustar/z0 is provided, and list lengths match.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.wind_dir">
<span class="sig-name descname"><span class="pre">wind_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">270.0</span></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.wind_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.wind_speed">
<span class="sig-name descname"><span class="pre">wind_speed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.0</span></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.wind_speed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.MetConfig.z0">
<span class="sig-name descname"><span class="pre">z0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.MetConfig.z0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.OutputConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">OutputConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'netcdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./output'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#OutputConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.OutputConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Output configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.OutputConfig.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'./output'</span></em><a class="headerlink" href="#bldfm.config_parser.OutputConfig.directory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.OutputConfig.format">
<span class="sig-name descname"><span class="pre">format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'netcdf'</span></em><a class="headerlink" href="#bldfm.config_parser.OutputConfig.format" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.ParallelConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">ParallelConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#ParallelConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.ParallelConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Parallelism configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.ParallelConfig.max_workers">
<span class="sig-name descname"><span class="pre">max_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#bldfm.config_parser.ParallelConfig.max_workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.ParallelConfig.num_threads">
<span class="sig-name descname"><span class="pre">num_threads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#bldfm.config_parser.ParallelConfig.num_threads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.ParallelConfig.use_cache">
<span class="sig-name descname"><span class="pre">use_cache</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bldfm.config_parser.ParallelConfig.use_cache" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">SolverConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MOST'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'single'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">footprint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_flux_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'diamond'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_loc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#SolverConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.SolverConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Solver configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig.analytic">
<span class="sig-name descname"><span class="pre">analytic</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bldfm.config_parser.SolverConfig.analytic" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig.closure">
<span class="sig-name descname"><span class="pre">closure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'MOST'</span></em><a class="headerlink" href="#bldfm.config_parser.SolverConfig.closure" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig.footprint">
<span class="sig-name descname"><span class="pre">footprint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bldfm.config_parser.SolverConfig.footprint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig.precision">
<span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'single'</span></em><a class="headerlink" href="#bldfm.config_parser.SolverConfig.precision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig.src_loc">
<span class="sig-name descname"><span class="pre">src_loc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bldfm.config_parser.SolverConfig.src_loc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.SolverConfig.surface_flux_shape">
<span class="sig-name descname"><span class="pre">surface_flux_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'diamond'</span></em><a class="headerlink" href="#bldfm.config_parser.SolverConfig.surface_flux_shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">TowerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#TowerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.TowerConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Configuration for a single measurement tower.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.compute_local_xy">
<span class="sig-name descname"><span class="pre">compute_local_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#TowerConfig.compute_local_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.TowerConfig.compute_local_xy" title="Link to this definition">¶</a></dt>
<dd><p>Compute local x/y from lat/lon and reference origin.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.lat">
<span class="sig-name descname"><span class="pre">lat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#bldfm.config_parser.TowerConfig.lat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.lon">
<span class="sig-name descname"><span class="pre">lon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#bldfm.config_parser.TowerConfig.lon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><a class="headerlink" href="#bldfm.config_parser.TowerConfig.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.x">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#bldfm.config_parser.TowerConfig.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.y">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#bldfm.config_parser.TowerConfig.y" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bldfm.config_parser.TowerConfig.z_m">
<span class="sig-name descname"><span class="pre">z_m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></em><a class="headerlink" href="#bldfm.config_parser.TowerConfig.z_m" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.config_parser.latlon_to_xy">
<span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">latlon_to_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_lon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/config_parser.html#latlon_to_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.latlon_to_xy" title="Link to this definition">¶</a></dt>
<dd><p>Convert lat/lon to local x/y (meters) relative to a reference point.</p>
<p>Uses an equirectangular (flat-Earth) approximation, which is accurate
to &lt;0.1% for domains up to ~100 km at mid-latitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Point coordinates in decimal degrees.</p></li>
<li><p><strong>lon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Point coordinates in decimal degrees.</p></li>
<li><p><strong>ref_lat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Reference origin coordinates in decimal degrees.</p></li>
<li><p><strong>ref_lon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Reference origin coordinates in decimal degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x, y</strong> – Easting and northing in meters relative to (ref_lat, ref_lon).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.config_parser.load_config">
<span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">load_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><span class="pre">BLDFMConfig</span></a></span></span><a class="reference internal" href="_modules/bldfm/config_parser.html#load_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.load_config" title="Link to this definition">¶</a></dt>
<dd><p>Load a BLDFM configuration from a YAML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>Path</em>) – Path to the YAML configuration file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed and validated configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig">BLDFMConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.config_parser.parse_config_dict">
<span class="sig-prename descclassname"><span class="pre">bldfm.config_parser.</span></span><span class="sig-name descname"><span class="pre">parse_config_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><span class="pre">BLDFMConfig</span></a></span></span><a class="reference internal" href="_modules/bldfm/config_parser.html#parse_config_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.config_parser.parse_config_dict" title="Link to this definition">¶</a></dt>
<dd><p>Parse a BLDFM configuration from a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raw</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Raw configuration dictionary (e.g. from YAML).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed and validated configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig">BLDFMConfig</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.interface">
<span id="bldfm-interface-module"></span><h3>bldfm.interface module<a class="headerlink" href="#module-bldfm.interface" title="Link to this heading">¶</a></h3>
<p>High-level interface for running BLDFM simulations.</p>
<p>Provides convenience functions that wrap the manual workflow of
compute_wind_fields -&gt; vertical_profiles -&gt; steady_state_transport_solver
into single function calls driven by configuration objects.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.interface.run_bldfm_multitower">
<span class="sig-prename descclassname"><span class="pre">bldfm.interface.</span></span><span class="sig-name descname"><span class="pre">run_bldfm_multitower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><span class="pre">BLDFMConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/bldfm/interface.html#run_bldfm_multitower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.interface.run_bldfm_multitower" title="Link to this definition">¶</a></dt>
<dd><p>Run BLDFM for all towers and all timesteps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Full BLDFM configuration with towers and met data.</p></li>
<li><p><strong>surface_flux</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – 2D surface flux field (reused for all towers/timesteps).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of tower_name -&gt; list of result dicts (one per timestep).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.interface.run_bldfm_parallel">
<span class="sig-prename descclassname"><span class="pre">bldfm.interface.</span></span><span class="sig-name descname"><span class="pre">run_bldfm_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><span class="pre">BLDFMConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel_over</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'towers'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/bldfm/interface.html#run_bldfm_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.interface.run_bldfm_parallel" title="Link to this definition">¶</a></dt>
<dd><p>Run BLDFM in parallel using ProcessPoolExecutor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Full BLDFM configuration with towers and met data.</p></li>
<li><p><strong>max_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of worker processes. Defaults to config.parallel.max_workers.</p></li>
<li><p><strong>parallel_over</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Parallelization strategy:
- “towers”: distribute towers across workers, each runs full timeseries
- “time”: for each tower, distribute timesteps across workers
- “both”: flatten all (tower, timestep) pairs across workers</p></li>
<li><p><strong>surface_flux</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – 2D surface flux field (not passed to subprocesses to avoid large
serialization; each worker generates its own ideal source).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of tower_name -&gt; list of result dicts (one per timestep).
Same format as run_bldfm_multitower.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.interface.run_bldfm_single">
<span class="sig-prename descclassname"><span class="pre">bldfm.interface.</span></span><span class="sig-name descname"><span class="pre">run_bldfm_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><span class="pre">BLDFMConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><span class="pre">TowerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">met_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/bldfm/interface.html#run_bldfm_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.interface.run_bldfm_single" title="Link to this definition">¶</a></dt>
<dd><p>Run a single BLDFM solve for one tower at one timestep.</p>
<dl class="simple">
<dt>Encapsulates the 3-step workflow:</dt><dd><ol class="arabic simple">
<li><p>compute_wind_fields(wind_speed, wind_dir) -&gt; (u, v)</p></li>
<li><p>vertical_profiles(nz, z_m, (u, v), …) -&gt; (z, profiles)</p></li>
<li><p>steady_state_transport_solver(srf_flx, z, profiles, …) -&gt; (grid, conc, flx)</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Full BLDFM configuration.</p></li>
<li><p><strong>tower</strong> (<a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><em>TowerConfig</em></a>) – Tower to compute footprint/concentration for.</p></li>
<li><p><strong>met_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index into the met timeseries (0 for single-timestep configs).</p></li>
<li><p><strong>surface_flux</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – 2D surface flux field. If None, generates an ideal source.</p></li>
<li><p><strong>cache</strong> (<a class="reference internal" href="#bldfm.cache.GreensFunctionCache" title="bldfm.cache.GreensFunctionCache"><em>GreensFunctionCache</em></a><em>, </em><em>optional</em>) – Cache instance for footprint reuse.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result dictionary with keys:
- grid: (X, Y, Z) coordinate arrays
- conc: concentration field
- flx: flux field
- tower_name: name of the tower
- timestamp: timestamp or index
- params: dict of met parameters used</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.interface.run_bldfm_timeseries">
<span class="sig-prename descclassname"><span class="pre">bldfm.interface.</span></span><span class="sig-name descname"><span class="pre">run_bldfm_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><span class="pre">BLDFMConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><span class="pre">TowerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_flux</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></span><a class="reference internal" href="_modules/bldfm/interface.html#run_bldfm_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.interface.run_bldfm_timeseries" title="Link to this definition">¶</a></dt>
<dd><p>Run BLDFM for all timesteps in the met config for a single tower.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Full BLDFM configuration with timeseries met data.</p></li>
<li><p><strong>tower</strong> (<a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><em>TowerConfig</em></a>) – Tower to compute footprint/concentration for.</p></li>
<li><p><strong>surface_flux</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – 2D surface flux field (reused for all timesteps).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One result dict per timestep (same format as run_bldfm_single).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.cli">
<span id="bldfm-cli-module"></span><h3>bldfm.cli module<a class="headerlink" href="#module-bldfm.cli" title="Link to this heading">¶</a></h3>
<p>Command-line interface for BLDFM.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>bldfm run config.yaml
bldfm run config.yaml –dry-run
bldfm run config.yaml –plot</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.cli.cmd_run">
<span class="sig-prename descclassname"><span class="pre">bldfm.cli.</span></span><span class="sig-name descname"><span class="pre">cmd_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/cli.html#cmd_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.cli.cmd_run" title="Link to this definition">¶</a></dt>
<dd><p>Execute a BLDFM run from a YAML config file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.cli.main">
<span class="sig-prename descclassname"><span class="pre">bldfm.cli.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/cli.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.cli.main" title="Link to this definition">¶</a></dt>
<dd><p>Main CLI entry point.</p>
</dd></dl>

</section>
</section>
<section id="data-and-i-o">
<h2>Data and I/O<a class="headerlink" href="#data-and-i-o" title="Link to this heading">¶</a></h2>
<section id="module-bldfm.synthetic">
<span id="bldfm-synthetic-module"></span><h3>bldfm.synthetic module<a class="headerlink" href="#module-bldfm.synthetic" title="Link to this heading">¶</a></h3>
<p>Synthetic data generators for testing and demonstration.</p>
<p>Provides functions to generate realistic-looking meteorological timeseries
and tower grid configurations without requiring real observational data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.synthetic.generate_synthetic_timeseries">
<span class="sig-prename descclassname"><span class="pre">bldfm.synthetic.</span></span><span class="sig-name descname"><span class="pre">generate_synthetic_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_timesteps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_minutes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'2024-01-01T00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ustar_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.1,</span> <span class="pre">0.8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-500.0,</span> <span class="pre">500.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_speed_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">8.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_dir_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">270.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_dir_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/bldfm/synthetic.html#generate_synthetic_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.synthetic.generate_synthetic_timeseries" title="Link to this definition">¶</a></dt>
<dd><p>Generate a synthetic meteorological timeseries with diurnal cycle.</p>
<p>Produces ustar, Monin-Obukhov length, wind speed, and wind direction
arrays that follow a realistic diurnal pattern (unstable daytime,
stable nighttime) with added noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_timesteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of time steps to generate.</p></li>
<li><p><strong>dt_minutes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Time step interval in minutes.</p></li>
<li><p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – ISO-format start time string.</p></li>
<li><p><strong>ustar_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – (min, max) friction velocity [m/s].</p></li>
<li><p><strong>mol_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – (min_negative, max_positive) Monin-Obukhov length [m].
Negative = unstable, positive = stable.</p></li>
<li><p><strong>wind_speed_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – (min, max) wind speed [m/s].</p></li>
<li><p><strong>wind_dir_mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Mean wind direction [degrees].</p></li>
<li><p><strong>wind_dir_std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Standard deviation of wind direction [degrees].</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with keys matching MetConfig schema:
ustar, mol, wind_speed, wind_dir, timestamps (all lists).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.synthetic.generate_towers_grid">
<span class="sig-prename descclassname"><span class="pre">bldfm.synthetic.</span></span><span class="sig-name descname"><span class="pre">generate_towers_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_towers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">11.586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'grid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bldfm/synthetic.html#generate_towers_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.synthetic.generate_towers_grid" title="Link to this definition">¶</a></dt>
<dd><p>Generate tower configurations in various spatial layouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_towers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of towers to generate.</p></li>
<li><p><strong>center_lat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Center point of the tower array [decimal degrees].</p></li>
<li><p><strong>center_lon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Center point of the tower array [decimal degrees].</p></li>
<li><p><strong>spacing_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Approximate spacing between towers [meters].</p></li>
<li><p><strong>z_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Measurement height [meters] (same for all towers).</p></li>
<li><p><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Spatial layout: “grid”, “random”, or “transect”.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Random seed for reproducibility (used by “random” layout).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tower configurations matching TowerConfig schema.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.io">
<span id="bldfm-io-module"></span><h3>bldfm.io module<a class="headerlink" href="#module-bldfm.io" title="Link to this heading">¶</a></h3>
<p>NetCDF I/O for BLDFM footprint results.</p>
<p>Saves and loads multi-tower, multi-timestep footprint fields as CF-1.8
compliant xarray Datasets with zlib compression.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.io.load_footprints_from_netcdf">
<span class="sig-prename descclassname"><span class="pre">bldfm.io.</span></span><span class="sig-name descname"><span class="pre">load_footprints_from_netcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/io.html#load_footprints_from_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.io.load_footprints_from_netcdf" title="Link to this definition">¶</a></dt>
<dd><p>Load footprint results from a NetCDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>Path</em>) – Path to the NetCDF file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset with footprint, concentration, and metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.io.save_footprints_to_netcdf">
<span class="sig-prename descclassname"><span class="pre">bldfm.io.</span></span><span class="sig-name descname"><span class="pre">save_footprints_to_netcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/io.html#save_footprints_to_netcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.io.save_footprints_to_netcdf" title="Link to this definition">¶</a></dt>
<dd><p>Save multitower results to a CF-compliant NetCDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output of run_bldfm_multitower: {tower_name: [result_dict, …]}.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Configuration used for the run.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>Path</em>) – Output file path.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.cache">
<span id="bldfm-cache-module"></span><h3>bldfm.cache module<a class="headerlink" href="#module-bldfm.cache" title="Link to this heading">¶</a></h3>
<p>Disk cache for Green’s function results.</p>
<p>When footprint=True, the solver output depends only on the vertical profiles,
domain geometry, and measurement point — not on the surface flux field. Caching
these results avoids redundant solves when re-running with the same PBL/domain
configuration.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bldfm.cache.GreensFunctionCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bldfm.cache.</span></span><span class="sig-name descname"><span class="pre">GreensFunctionCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.bldfm_cache'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/cache.html#GreensFunctionCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.cache.GreensFunctionCache" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Disk-based cache for Green’s function solver outputs.</p>
<p>Cache key is a SHA-256 hash of the solver inputs that determine the
Green’s function: vertical grid, profiles, domain, modes, measurement
point, halo, and precision.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cache_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>Path</em>) – Directory for cache files. Created if it does not exist.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bldfm.cache.GreensFunctionCache.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/cache.html#GreensFunctionCache.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.cache.GreensFunctionCache.clear" title="Link to this definition">¶</a></dt>
<dd><p>Remove all cached files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bldfm.cache.GreensFunctionCache.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/cache.html#GreensFunctionCache.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.cache.GreensFunctionCache.get" title="Link to this definition">¶</a></dt>
<dd><p>Look up cached result.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(grid, conc, flx) if cached, None on miss.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bldfm.cache.GreensFunctionCache.put">
<span class="sig-name descname"><span class="pre">put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/cache.html#GreensFunctionCache.put"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.cache.GreensFunctionCache.put" title="Link to this definition">¶</a></dt>
<dd><p>Store a result in the cache.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Link to this heading">¶</a></h2>
<section id="module-bldfm.plotting">
<span id="bldfm-plotting-package"></span><h3>bldfm.plotting package<a class="headerlink" href="#module-bldfm.plotting" title="Link to this heading">¶</a></h3>
<p>Plotting package for BLDFM footprint visualisation.</p>
<p>All matplotlib-based functions accept an optional <code class="docutils literal notranslate"><span class="pre">ax</span></code> parameter for
composability.  Optional dependencies (contextily, windrose, plotly) are
imported lazily and raise helpful messages when missing.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.extract_percentile_contour">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">extract_percentile_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/footprint.html#extract_percentile_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.extract_percentile_contour" title="Link to this definition">¶</a></dt>
<dd><p>Find the contour level that encloses <em>pct</em> of the cumulative footprint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – 2-D footprint field (non-negative). If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>pct</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Fraction of the total footprint to enclose (0-1).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>level</strong> (<em>float</em>) – Contour level value.</p></li>
<li><p><strong>area</strong> (<em>float</em>) – Approximate area [m^2] enclosed by that contour.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_convergence">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$h$</span> <span class="pre">[m]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Relative</span> <span class="pre">RMSE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/diagnostics.html#plot_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Log-log convergence plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_sizes</strong> (<em>array-like</em>) – Effective grid spacings (h).</p></li>
<li><p><strong>errors</strong> (<em>array-like</em>) – Error values (e.g., RMSE).</p></li>
<li><p><strong>fits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>(</em><em>func</em><em>, </em><em>params</em><em>, </em><em>label</em><em>)</em><em>, </em><em>optional</em>) – Curve fits to overlay. Each element is a tuple:
(function, parameter_dict, label_string).
Example: (lambda h, a, b: a * h**b, {“a”: 0.1, “b”: 2.0}, “$O(h^2)$”)</p></li>
<li><p><strong>marker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Marker style for data points (default “o”).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – X-axis label (default “$h$ [m]”).</p></li>
<li><p><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Y-axis label (default “Relative RMSE”).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_field_comparison">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_field_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'turbo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/comparison.html#plot_field_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_field_comparison" title="Link to this definition">¶</a></dt>
<dd><p>2x2 panel comparison: conc, flux, and relative differences.</p>
<p>Top-left: concentration, top-right: flux.
Bottom-left: relative difference concentration, bottom-right: relative difference flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Must contain keys: “conc”, “flx”, “conc_ref”, “flx_ref”.
Values may be 2-D or 3-D arrays. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xmax</em><em>, </em><em>ymax</em><em>)</em>) – Domain extents for imshow.</p></li>
<li><p><strong>src_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>x</em><em>, </em><em>y</em><em>)</em><em>, </em><em>optional</em>) – Source point coordinates to mark with a red star on top panels.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colormap name (default “turbo”).</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height). Default (10, 6).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when fields are 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes (2x2)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_footprint_comparison">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'turbo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/comparison.html#plot_footprint_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_footprint_comparison" title="Link to this definition">¶</a></dt>
<dd><p>Multi-panel contour plot comparing footprint models side-by-side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>ndarray</em>) – List of 2-D (or 3-D) footprint fields to compare. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grids</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – List of (X, Y) or (X, Y, Z) coordinate arrays (one per field).</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Subplot titles.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>x</em><em>, </em><em>y</em><em>)</em><em>, </em><em>optional</em>) – Measurement point coordinates to mark with a red star on each panel.</p></li>
<li><p><strong>n_levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of contour levels (default 6).</p></li>
<li><p><strong>vmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum contour level. If None, uses 5% of vmax.</p></li>
<li><p><strong>vmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum contour level. If None, uses max across all fields.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colormap name (default “turbo”).</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Overall figure title.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when fields are 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_footprint_field">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_pcts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pcolormesh_kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/footprint.html#plot_footprint_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_footprint_field" title="Link to this definition">¶</a></dt>
<dd><p>Plot a 2-D footprint field with optional percentile contours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint (or concentration) field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>contour_pcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Percentile fractions to overlay as contours (e.g. [0.5, 0.8]).</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap name.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
<li><p><strong>**pcolormesh_kw</strong> – Forwarded to <code class="docutils literal notranslate"><span class="pre">ax.pcolormesh</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_footprint_interactive">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_interactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/interactive.html#plot_footprint_interactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_footprint_interactive" title="Link to this definition">¶</a></dt>
<dd><p>Create an interactive Plotly heatmap of the footprint.</p>
<p>Requires the optional <code class="docutils literal notranslate"><span class="pre">plotly</span></code> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>xlim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – (xmin, xmax) axis range.  Useful for excluding halo padding.</p></li>
<li><p><strong>ylim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – (ymin, ymax) axis range.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotly.graph_objects.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_footprint_on_map">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_on_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_pcts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_cover</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_cover_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(512,</span> <span class="pre">512)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/footprint.html#plot_footprint_on_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_footprint_on_map" title="Link to this definition">¶</a></dt>
<dd><p>Overlay footprint contours and tower marker(s) on map tiles.</p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">contextily</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">owslib</span></code> (when <em>land_cover=True</em>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays (local metres).</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Configuration (for ref_lat/ref_lon and tower metadata).</p></li>
<li><p><strong>tower</strong> (<a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><em>TowerConfig</em></a><em>, </em><em>optional</em>) – Specific tower to highlight.  If None, all towers are plotted.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>contour_pcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Percentile contours to draw (default [0.5, 0.8]).</p></li>
<li><p><strong>tile_source</strong> (<em>contextily tile source</em><em>, </em><em>optional</em>) – Defaults to OpenStreetMap.  Ignored when <em>land_cover=True</em> unless
explicitly provided (in which case both layers are rendered).</p></li>
<li><p><strong>land_cover</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, use ESA WorldCover 2021 as the basemap instead of OSM
tiles.  Requires the optional <code class="docutils literal notranslate"><span class="pre">owslib</span></code> package.</p></li>
<li><p><strong>land_cover_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Pixel dimensions (width, height) for the WMS request (default
(512, 512)).  Increase for higher resolution.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Transparency for footprint fill.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap for the footprint fill.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_footprint_timeseries">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/timeseries.html#plot_footprint_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_footprint_timeseries" title="Link to this definition">¶</a></dt>
<dd><p>Plot temporal evolution of footprint extent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output of run_bldfm_timeseries (list of result dicts for one tower).</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays (from first result, assumed constant).</p></li>
<li><p><strong>pcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Percentile fractions to track (default [0.5, 0.8]).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when footprint fields are 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_source_area_contours">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_source_area_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_area_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pcolormesh_kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/contours.html#plot_source_area_contours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_source_area_contours" title="Link to this definition">¶</a></dt>
<dd><p>Plot footprint field with source area contour overlay.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">source_area_field</span></code> should be the output of
<code class="docutils literal notranslate"><span class="pre">get_source_area(flx,</span> <span class="pre">g)</span></code> for some base function <code class="docutils literal notranslate"><span class="pre">g</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Original footprint field (plotted as pcolormesh background).
If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>) or </em><em>(</em><em>X</em><em>, </em><em>Y</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>source_area_field</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Rescaled field from <code class="docutils literal notranslate"><span class="pre">get_source_area()</span></code>, where contour levels
represent cumulative contribution fractions.
If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Contribution fraction levels (default [0.25, 0.5, 0.75]).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>contour_colors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Colors for contour lines (default [‘white’, ‘magenta’, ‘cyan’]).</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap for background pcolormesh.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when fields are 3D. Default 0 (surface).</p></li>
<li><p><strong>colorbar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to add a colorbar. Default True.</p></li>
<li><p><strong>**pcolormesh_kw</strong> – Forwarded to <code class="docutils literal notranslate"><span class="pre">ax.pcolormesh</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_source_area_gallery">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_source_area_gallery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/contours.html#plot_source_area_gallery"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_source_area_gallery" title="Link to this definition">¶</a></dt>
<dd><p>Multi-panel plot showing all 5 source area contour types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>) or </em><em>(</em><em>X</em><em>, </em><em>Y</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xm</em><em>, </em><em>ym</em><em>)</em>) – Measurement point.</p></li>
<li><p><strong>wind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>u</em><em>, </em><em>v</em><em>)</em>) – Wind components (m/s).</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Contribution fraction levels (default [0.25, 0.5, 0.75]).</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap for background.</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (default (18, 10)).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes (2, 3)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_vertical_profiles">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_vertical_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/diagnostics.html#plot_vertical_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_vertical_profiles" title="Link to this definition">¶</a></dt>
<dd><p>Multi-panel (1x2) profile plot: wind speed and diffusivity vs height.</p>
<p>Left panel: wind speed <a href="#id1"><span class="problematic" id="id2">|U|</span></a> = sqrt(u² + v²) vs z.
Right panel: Kz vs z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>array-like</em>) – List of z arrays (one per stability condition).</p></li>
<li><p><strong>profiles_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – List of profile tuples (u, v, Kx, Ky, Kz), one per stability condition.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Legend labels for each profile (e.g., “L = -10 m”).</p></li>
<li><p><strong>meas_height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Measurement height to mark with a horizontal dashed line.</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height). Default (10, 5).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Overall figure title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes (1x2)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_vertical_slice">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_vertical_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/diagnostics.html#plot_vertical_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_vertical_slice" title="Link to this definition">¶</a></dt>
<dd><p>2D slice from a 3D field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>ndarray</em><em> (</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – 3-D field to slice.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – 3-D coordinate arrays from the solver.</p></li>
<li><p><strong>slice_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Axis to slice along: “x”, “y”, or “z”.</p></li>
<li><p><strong>slice_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index along the slice axis.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colormap name (default “viridis”).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – X-axis label (auto-generated if None).</p></li>
<li><p><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Y-axis label (auto-generated if None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.plot_wind_rose">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_wind_rose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/meteorology.html#plot_wind_rose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.plot_wind_rose" title="Link to this definition">¶</a></dt>
<dd><p>Plot a wind rose from meteorological data.</p>
<p>Requires the optional <code class="docutils literal notranslate"><span class="pre">windrose</span></code> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wind_speed</strong> (<em>array-like</em>) – Wind speed values.</p></li>
<li><p><strong>wind_dir</strong> (<em>array-like</em>) – Wind direction values (degrees, meteorological convention).</p></li>
<li><p><strong>ax</strong> (<em>WindroseAxes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>bins</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Speed bins.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>WindroseAxes</p>
</dd>
</dl>
</dd></dl>

<section id="module-bldfm.plotting.footprint">
<span id="bldfm-plotting-footprint-module"></span><h4>bldfm.plotting.footprint module<a class="headerlink" href="#module-bldfm.plotting.footprint" title="Link to this heading">¶</a></h4>
<p>Core footprint plots and percentile contour computation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.footprint.extract_percentile_contour">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.footprint.</span></span><span class="sig-name descname"><span class="pre">extract_percentile_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/footprint.html#extract_percentile_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.footprint.extract_percentile_contour" title="Link to this definition">¶</a></dt>
<dd><p>Find the contour level that encloses <em>pct</em> of the cumulative footprint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – 2-D footprint field (non-negative). If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>pct</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Fraction of the total footprint to enclose (0-1).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>level</strong> (<em>float</em>) – Contour level value.</p></li>
<li><p><strong>area</strong> (<em>float</em>) – Approximate area [m^2] enclosed by that contour.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.footprint.plot_footprint_field">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.footprint.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_pcts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pcolormesh_kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/footprint.html#plot_footprint_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.footprint.plot_footprint_field" title="Link to this definition">¶</a></dt>
<dd><p>Plot a 2-D footprint field with optional percentile contours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint (or concentration) field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>contour_pcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Percentile fractions to overlay as contours (e.g. [0.5, 0.8]).</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap name.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
<li><p><strong>**pcolormesh_kw</strong> – Forwarded to <code class="docutils literal notranslate"><span class="pre">ax.pcolormesh</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.footprint.plot_footprint_on_map">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.footprint.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_on_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_pcts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_cover</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_cover_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(512,</span> <span class="pre">512)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/footprint.html#plot_footprint_on_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.footprint.plot_footprint_on_map" title="Link to this definition">¶</a></dt>
<dd><p>Overlay footprint contours and tower marker(s) on map tiles.</p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">contextily</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">owslib</span></code> (when <em>land_cover=True</em>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays (local metres).</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><em>BLDFMConfig</em></a>) – Configuration (for ref_lat/ref_lon and tower metadata).</p></li>
<li><p><strong>tower</strong> (<a class="reference internal" href="#bldfm.config_parser.TowerConfig" title="bldfm.config_parser.TowerConfig"><em>TowerConfig</em></a><em>, </em><em>optional</em>) – Specific tower to highlight.  If None, all towers are plotted.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>contour_pcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Percentile contours to draw (default [0.5, 0.8]).</p></li>
<li><p><strong>tile_source</strong> (<em>contextily tile source</em><em>, </em><em>optional</em>) – Defaults to OpenStreetMap.  Ignored when <em>land_cover=True</em> unless
explicitly provided (in which case both layers are rendered).</p></li>
<li><p><strong>land_cover</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, use ESA WorldCover 2021 as the basemap instead of OSM
tiles.  Requires the optional <code class="docutils literal notranslate"><span class="pre">owslib</span></code> package.</p></li>
<li><p><strong>land_cover_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Pixel dimensions (width, height) for the WMS request (default
(512, 512)).  Increase for higher resolution.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Transparency for footprint fill.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap for the footprint fill.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.plotting.comparison">
<span id="bldfm-plotting-comparison-module"></span><h4>bldfm.plotting.comparison module<a class="headerlink" href="#module-bldfm.plotting.comparison" title="Link to this heading">¶</a></h4>
<p>Multi-panel comparison plots.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.comparison.plot_field_comparison">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.comparison.</span></span><span class="sig-name descname"><span class="pre">plot_field_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'turbo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/comparison.html#plot_field_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.comparison.plot_field_comparison" title="Link to this definition">¶</a></dt>
<dd><p>2x2 panel comparison: conc, flux, and relative differences.</p>
<p>Top-left: concentration, top-right: flux.
Bottom-left: relative difference concentration, bottom-right: relative difference flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Must contain keys: “conc”, “flx”, “conc_ref”, “flx_ref”.
Values may be 2-D or 3-D arrays. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xmax</em><em>, </em><em>ymax</em><em>)</em>) – Domain extents for imshow.</p></li>
<li><p><strong>src_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>x</em><em>, </em><em>y</em><em>)</em><em>, </em><em>optional</em>) – Source point coordinates to mark with a red star on top panels.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colormap name (default “turbo”).</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height). Default (10, 6).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when fields are 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes (2x2)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.comparison.plot_footprint_comparison">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.comparison.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'turbo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/comparison.html#plot_footprint_comparison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.comparison.plot_footprint_comparison" title="Link to this definition">¶</a></dt>
<dd><p>Multi-panel contour plot comparing footprint models side-by-side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>ndarray</em>) – List of 2-D (or 3-D) footprint fields to compare. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grids</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – List of (X, Y) or (X, Y, Z) coordinate arrays (one per field).</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Subplot titles.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>x</em><em>, </em><em>y</em><em>)</em><em>, </em><em>optional</em>) – Measurement point coordinates to mark with a red star on each panel.</p></li>
<li><p><strong>n_levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of contour levels (default 6).</p></li>
<li><p><strong>vmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum contour level. If None, uses 5% of vmax.</p></li>
<li><p><strong>vmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Maximum contour level. If None, uses max across all fields.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colormap name (default “turbo”).</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Overall figure title.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when fields are 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.plotting.diagnostics">
<span id="bldfm-plotting-diagnostics-module"></span><h4>bldfm.plotting.diagnostics module<a class="headerlink" href="#module-bldfm.plotting.diagnostics" title="Link to this heading">¶</a></h4>
<p>Diagnostic and analysis plots: convergence, vertical profiles, vertical slices.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.diagnostics.plot_convergence">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.diagnostics.</span></span><span class="sig-name descname"><span class="pre">plot_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$h$</span> <span class="pre">[m]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Relative</span> <span class="pre">RMSE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/diagnostics.html#plot_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.diagnostics.plot_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Log-log convergence plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_sizes</strong> (<em>array-like</em>) – Effective grid spacings (h).</p></li>
<li><p><strong>errors</strong> (<em>array-like</em>) – Error values (e.g., RMSE).</p></li>
<li><p><strong>fits</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>(</em><em>func</em><em>, </em><em>params</em><em>, </em><em>label</em><em>)</em><em>, </em><em>optional</em>) – Curve fits to overlay. Each element is a tuple:
(function, parameter_dict, label_string).
Example: (lambda h, a, b: a * h**b, {“a”: 0.1, “b”: 2.0}, “$O(h^2)$”)</p></li>
<li><p><strong>marker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Marker style for data points (default “o”).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – X-axis label (default “$h$ [m]”).</p></li>
<li><p><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Y-axis label (default “Relative RMSE”).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.diagnostics.plot_vertical_profiles">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.diagnostics.</span></span><span class="sig-name descname"><span class="pre">plot_vertical_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/diagnostics.html#plot_vertical_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.diagnostics.plot_vertical_profiles" title="Link to this definition">¶</a></dt>
<dd><p>Multi-panel (1x2) profile plot: wind speed and diffusivity vs height.</p>
<p>Left panel: wind speed <a href="#id3"><span class="problematic" id="id4">|U|</span></a> = sqrt(u² + v²) vs z.
Right panel: Kz vs z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><em>array-like</em>) – List of z arrays (one per stability condition).</p></li>
<li><p><strong>profiles_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – List of profile tuples (u, v, Kx, Ky, Kz), one per stability condition.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Legend labels for each profile (e.g., “L = -10 m”).</p></li>
<li><p><strong>meas_height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Measurement height to mark with a horizontal dashed line.</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (width, height). Default (10, 5).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Overall figure title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes (1x2)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.diagnostics.plot_vertical_slice">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.diagnostics.</span></span><span class="sig-name descname"><span class="pre">plot_vertical_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/diagnostics.html#plot_vertical_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.diagnostics.plot_vertical_slice" title="Link to this definition">¶</a></dt>
<dd><p>2D slice from a 3D field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>ndarray</em><em> (</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – 3-D field to slice.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – 3-D coordinate arrays from the solver.</p></li>
<li><p><strong>slice_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Axis to slice along: “x”, “y”, or “z”.</p></li>
<li><p><strong>slice_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index along the slice axis.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colormap name (default “viridis”).</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – X-axis label (auto-generated if None).</p></li>
<li><p><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Y-axis label (auto-generated if None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.plotting.timeseries">
<span id="bldfm-plotting-timeseries-module"></span><h4>bldfm.plotting.timeseries module<a class="headerlink" href="#module-bldfm.plotting.timeseries" title="Link to this heading">¶</a></h4>
<p>Temporal footprint evolution plots.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.timeseries.plot_footprint_timeseries">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.timeseries.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/timeseries.html#plot_footprint_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.timeseries.plot_footprint_timeseries" title="Link to this definition">¶</a></dt>
<dd><p>Plot temporal evolution of footprint extent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output of run_bldfm_timeseries (list of result dicts for one tower).</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays (from first result, assumed constant).</p></li>
<li><p><strong>pcts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Percentile fractions to track (default [0.5, 0.8]).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when footprint fields are 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.plotting.interactive">
<span id="bldfm-plotting-interactive-module"></span><h4>bldfm.plotting.interactive module<a class="headerlink" href="#module-bldfm.plotting.interactive" title="Link to this heading">¶</a></h4>
<p>Interactive (non-matplotlib) plotting backends.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.interactive.plot_footprint_interactive">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.interactive.</span></span><span class="sig-name descname"><span class="pre">plot_footprint_interactive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/interactive.html#plot_footprint_interactive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.interactive.plot_footprint_interactive" title="Link to this definition">¶</a></dt>
<dd><p>Create an interactive Plotly heatmap of the footprint.</p>
<p>Requires the optional <code class="docutils literal notranslate"><span class="pre">plotly</span></code> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>)</em>) – Coordinate arrays.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>xlim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – (xmin, xmax) axis range.  Useful for excluding halo padding.</p></li>
<li><p><strong>ylim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – (ymin, ymax) axis range.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotly.graph_objects.Figure</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.plotting.meteorology">
<span id="bldfm-plotting-meteorology-module"></span><h4>bldfm.plotting.meteorology module<a class="headerlink" href="#module-bldfm.plotting.meteorology" title="Link to this heading">¶</a></h4>
<p>Meteorological data visualizations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.meteorology.plot_wind_rose">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.meteorology.</span></span><span class="sig-name descname"><span class="pre">plot_wind_rose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/meteorology.html#plot_wind_rose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.meteorology.plot_wind_rose" title="Link to this definition">¶</a></dt>
<dd><p>Plot a wind rose from meteorological data.</p>
<p>Requires the optional <code class="docutils literal notranslate"><span class="pre">windrose</span></code> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wind_speed</strong> (<em>array-like</em>) – Wind speed values.</p></li>
<li><p><strong>wind_dir</strong> (<em>array-like</em>) – Wind direction values (degrees, meteorological convention).</p></li>
<li><p><strong>ax</strong> (<em>WindroseAxes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>bins</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Speed bins.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>WindroseAxes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bldfm.plotting.contours">
<span id="bldfm-plotting-contours-module"></span><h4>bldfm.plotting.contours module<a class="headerlink" href="#module-bldfm.plotting.contours" title="Link to this heading">¶</a></h4>
<p>Source area contour visualization functions.</p>
<p>These functions combine the output of <code class="docutils literal notranslate"><span class="pre">bldfm.utils.get_source_area()</span></code>
with matplotlib contour overlays.  The <code class="docutils literal notranslate"><span class="pre">get_source_area</span></code> computation
itself lives in <code class="docutils literal notranslate"><span class="pre">bldfm.utils</span></code> – this module handles only visualization.</p>
<p>Source area contours represent the spatial region that contributes a given
fraction of the measured flux.  Different “base functions” produce different
contour geometries:</p>
<ul class="simple">
<li><p><strong>Contribution contours</strong> (g = f): standard isopleth contours</p></li>
<li><p><strong>Circular contours</strong> (g = -(r^2)): concentric circles from tower</p></li>
<li><p><strong>Upwind contours</strong> (g = dot(wind_hat, r)): upwind distance bands</p></li>
<li><p><strong>Crosswind contours</strong> (g = -(perp distance)^2): crosswind ridges</p></li>
<li><p><strong>Sector contours</strong> (g = -abs(theta)): angular sectors from upwind axis</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#bldfm.utils.get_source_area" title="bldfm.utils.get_source_area"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bldfm.utils.get_source_area</span></code></a></dt><dd><p>Rescale a field so contour levels represent cumulative contribution fractions.</p>
</dd>
</dl>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.contours.plot_source_area_contours">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.contours.</span></span><span class="sig-name descname"><span class="pre">plot_source_area_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_area_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pcolormesh_kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/contours.html#plot_source_area_contours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.contours.plot_source_area_contours" title="Link to this definition">¶</a></dt>
<dd><p>Plot footprint field with source area contour overlay.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">source_area_field</span></code> should be the output of
<code class="docutils literal notranslate"><span class="pre">get_source_area(flx,</span> <span class="pre">g)</span></code> for some base function <code class="docutils literal notranslate"><span class="pre">g</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Original footprint field (plotted as pcolormesh background).
If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>) or </em><em>(</em><em>X</em><em>, </em><em>Y</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>source_area_field</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Rescaled field from <code class="docutils literal notranslate"><span class="pre">get_source_area()</span></code>, where contour levels
represent cumulative contribution fractions.
If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Contribution fraction levels (default [0.25, 0.5, 0.75]).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib Axes</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>contour_colors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Colors for contour lines (default [‘white’, ‘magenta’, ‘cyan’]).</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap for background pcolormesh.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when fields are 3D. Default 0 (surface).</p></li>
<li><p><strong>colorbar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to add a colorbar. Default True.</p></li>
<li><p><strong>**pcolormesh_kw</strong> – Forwarded to <code class="docutils literal notranslate"><span class="pre">ax.pcolormesh</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bldfm.plotting.contours.plot_source_area_gallery">
<span class="sig-prename descclassname"><span class="pre">bldfm.plotting.contours.</span></span><span class="sig-name descname"><span class="pre">plot_source_area_gallery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bldfm/plotting/contours.html#plot_source_area_gallery"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bldfm.plotting.contours.plot_source_area_gallery" title="Link to this definition">¶</a></dt>
<dd><p>Multi-panel plot showing all 5 source area contour types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flx</strong> (<em>ndarray</em><em> (</em><em>ny</em><em>, </em><em>nx</em><em>) or </em><em>(</em><em>nz</em><em>, </em><em>ny</em><em>, </em><em>nx</em><em>)</em>) – Footprint field. If 3D, sliced at <em>level</em>.</p></li>
<li><p><strong>grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>X</em><em>, </em><em>Y</em><em>, </em><em>Z</em><em>) or </em><em>(</em><em>X</em><em>, </em><em>Y</em><em>)</em>) – Coordinate arrays from the solver.</p></li>
<li><p><strong>meas_pt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>xm</em><em>, </em><em>ym</em><em>)</em>) – Measurement point.</p></li>
<li><p><strong>wind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> (</em><em>u</em><em>, </em><em>v</em><em>)</em>) – Wind components (m/s).</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Contribution fraction levels (default [0.25, 0.5, 0.75]).</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Colourmap for background.</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>, </em><em>optional</em>) – Figure size (default (18, 10)).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Z-index to use when <em>flx</em> is 3D. Default 0 (surface).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib Figure</em>)</p></li>
<li><p><strong>axes</strong> (<em>ndarray of Axes (2, 3)</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="overview.html" title="Previous document">Package overview</a>
        </li>
        <li>
          <a href="runs.html" title="Next document">Example scripts and workflows</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Mark Schlutow, Ray Chew, Mathias Göckede.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/src.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>