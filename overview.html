<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Package overview &#8212; BLDFM 1.0.0-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=89e598d8" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=56c4699f" />
    <script src="_static/documentation_options.js?v=8313637b"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The bldfm package" href="src.html" />
    <link rel="prev" title="Quick reference" href="reference.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo" />
    
    <h1 class="logo logo-name">BLDFM</h1>
    
  </a>
</p>



<p class="blurb">A Python dispersion and footprint model</p>






<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_quickstart.html">Quickstart tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_full.html">Full tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Quick reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Package overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#core-modules">Core modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-and-interface">Configuration and interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-and-i-o">Data and I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipeline-architecture">Pipeline architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-philosophy-high-level-vs-low-level-api">Design philosophy: high-level vs. low-level API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-reference">API reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="src.html">API reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SchlutowSM2Group/BLDFM">GitHub repository</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="runs.html">Example scripts and workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">The <code class="docutils literal notranslate"><span class="pre">tests</span></code> subpackage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Glossary Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="py-modindex.html">Module Index</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="reference.html" title="previous chapter">Quick reference</a></li>
      <li>Next: <a href="src.html" title="next chapter">The <code class="docutils literal notranslate"><span class="pre">bldfm</span></code> package</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="reference.html" title="Previous document">Quick reference</a>
        </li>
        <li>
          <a href="src.html" title="Next document">The <code class="docutils literal notranslate"><span class="pre">bldfm</span></code> package</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="package-overview">
<h1>Package overview<a class="headerlink" href="#package-overview" title="Link to this heading">¶</a></h1>
<p>BLDFM provides a modular framework for modelling atmospheric dispersion and flux footprints in the planetary boundary layer (PBL). It numerically solves the three-dimensional steady-state advection-diffusion equation and computes Green’s function footprints for flux tower networks.</p>
<section id="core-modules">
<h2>Core modules<a class="headerlink" href="#core-modules" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><dl>
<dt><a class="reference internal" href="src.html#module-bldfm.pbl_model" title="bldfm.pbl_model"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.pbl_model</span></code></a></dt><dd><p>Computes vertical profiles of horizontal wind and eddy diffusivity using Monin-Obukhov Similarity Theory (MOST).</p>
<dl class="simple">
<dt><strong>Key functions:</strong></dt><dd><ul class="simple">
<li><p><a class="reference internal" href="src.html#bldfm.pbl_model.vertical_profiles" title="bldfm.pbl_model.vertical_profiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.pbl_model.vertical_profiles()</span></code></a></p></li>
<li><p><a class="reference internal" href="src.html#bldfm.pbl_model.psi" title="bldfm.pbl_model.psi"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.pbl_model.psi()</span></code></a></p></li>
<li><p><a class="reference internal" href="src.html#bldfm.pbl_model.phi" title="bldfm.pbl_model.phi"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.pbl_model.phi()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl>
<dt><a class="reference internal" href="src.html#module-bldfm.solver" title="bldfm.solver"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.solver</span></code></a></dt><dd><p>Solves the steady-state advection-diffusion equation using FFT-based methods with linear shooting for the vertical boundary value problem.</p>
<dl class="simple">
<dt><strong>Key functions:</strong></dt><dd><ul class="simple">
<li><p><a class="reference internal" href="src.html#bldfm.solver.steady_state_transport_solver" title="bldfm.solver.steady_state_transport_solver"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.solver.steady_state_transport_solver()</span></code></a></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.solver.ivp_solver()</span></code></p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl>
<dt><a class="reference internal" href="src.html#module-bldfm.utils" title="bldfm.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.utils</span></code></a></dt><dd><p>Utility functions for wind field construction, source generation, and diagnostics.</p>
<dl class="simple">
<dt><strong>Key functions:</strong></dt><dd><ul class="simple">
<li><p><a class="reference internal" href="src.html#bldfm.utils.compute_wind_fields" title="bldfm.utils.compute_wind_fields"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.utils.compute_wind_fields()</span></code></a></p></li>
<li><p><a class="reference internal" href="src.html#bldfm.utils.ideal_source" title="bldfm.utils.ideal_source"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.utils.ideal_source()</span></code></a></p></li>
<li><p><a class="reference internal" href="src.html#bldfm.utils.point_measurement" title="bldfm.utils.point_measurement"><code class="xref py py-func docutils literal notranslate"><span class="pre">bldfm.utils.point_measurement()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
</section>
<section id="configuration-and-interface">
<h2>Configuration and interface<a class="headerlink" href="#configuration-and-interface" title="Link to this heading">¶</a></h2>
<ol class="arabic simple" start="4">
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.config_parser" title="bldfm.config_parser"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.config_parser</span></code></a></dt><dd><p>YAML-based configuration with dataclass schema. Defines <code class="docutils literal notranslate"><span class="pre">BLDFMConfig</span></code>, <code class="docutils literal notranslate"><span class="pre">TowerConfig</span></code>, <code class="docutils literal notranslate"><span class="pre">DomainConfig</span></code>, <code class="docutils literal notranslate"><span class="pre">MetConfig</span></code>, and related classes.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.interface" title="bldfm.interface"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.interface</span></code></a></dt><dd><p>High-level functions that encapsulate the full workflow:</p>
<ul class="simple">
<li><p><a class="reference internal" href="src.html#bldfm.interface.run_bldfm_single" title="bldfm.interface.run_bldfm_single"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_bldfm_single()</span></code></a> – single tower, single timestep</p></li>
<li><p><a class="reference internal" href="src.html#bldfm.interface.run_bldfm_timeseries" title="bldfm.interface.run_bldfm_timeseries"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_bldfm_timeseries()</span></code></a> – single tower, all timesteps</p></li>
<li><p><a class="reference internal" href="src.html#bldfm.interface.run_bldfm_multitower" title="bldfm.interface.run_bldfm_multitower"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_bldfm_multitower()</span></code></a> – all towers, all timesteps</p></li>
<li><p><a class="reference internal" href="src.html#bldfm.interface.run_bldfm_parallel" title="bldfm.interface.run_bldfm_parallel"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_bldfm_parallel()</span></code></a> – parallel execution over towers, time, or both</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.cli" title="bldfm.cli"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.cli</span></code></a></dt><dd><p>Command-line interface: <code class="docutils literal notranslate"><span class="pre">bldfm</span> <span class="pre">run</span> <span class="pre">config.yaml</span> <span class="pre">[--dry-run]</span></code>.</p>
</dd>
</dl>
</li>
</ol>
</section>
<section id="data-and-i-o">
<h2>Data and I/O<a class="headerlink" href="#data-and-i-o" title="Link to this heading">¶</a></h2>
<ol class="arabic simple" start="7">
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.synthetic" title="bldfm.synthetic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.synthetic</span></code></a></dt><dd><p>Generates synthetic meteorological timeseries and tower configurations for testing and prototyping.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.io" title="bldfm.io"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.io</span></code></a></dt><dd><p>NetCDF export and import of footprint results using xarray with CF-1.8 metadata.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.cache" title="bldfm.cache"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.cache</span></code></a></dt><dd><p>Disk-based cache for Green’s function results using SHA-256 keyed <code class="docutils literal notranslate"><span class="pre">.npz</span></code> files.</p>
</dd>
</dl>
</li>
</ol>
</section>
<section id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Link to this heading">¶</a></h2>
<ol class="arabic simple" start="10">
<li><dl class="simple">
<dt><a class="reference internal" href="src.html#module-bldfm.plotting" title="bldfm.plotting"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.plotting</span></code></a></dt><dd><p>Visualisation functions for footprint fields, geospatial map overlays, wind roses, and temporal footprint evolution.</p>
</dd>
</dl>
</li>
</ol>
</section>
<section id="pipeline-architecture">
<h2>Pipeline architecture<a class="headerlink" href="#pipeline-architecture" title="Link to this heading">¶</a></h2>
<p>The solver pipeline proceeds in four stages. The high-level interface
(<a class="reference internal" href="src.html#module-bldfm.interface" title="bldfm.interface"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.interface</span></code></a>) runs all four automatically; the low-level API lets
you call each stage individually.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                 YAML file / dict
                       │
              load_config / parse_config_dict
                       │
                       ▼
                  BLDFMConfig
                       │
       ┌───────────────┼────────────────┐
       │          High-level            │
       │   run_bldfm_single/timeseries  │
       │   run_bldfm_multitower         │
       │   run_bldfm_parallel           │
       └───────────────┬────────────────┘
                       │  internally calls ▼
         ┌─────────────┼─────────────────┐
         │                               │
         ▼                               │
compute_wind_fields()  [utils]           │
         │                               │
         ▼                               │
vertical_profiles()    [pbl_model]       │
         │                               │
         ▼                               │
ideal_source()         [utils]           │
         │             (if no flux given)│
         ▼                               │
steady_state_transport_solver()  [solver]│
         │                               │
         └───────────────┬───────────────┘
                         ▼
              result dict {grid, conc, flx, …}
                         │
           ┌─────────────┼─────────────┐
           │             │             │
           ▼             ▼             ▼
   GreensFunctionCache  save to     plot_*()
       [cache]         NetCDF     [plotting]
                       [io]
</pre></div>
</div>
</section>
<section id="design-philosophy-high-level-vs-low-level-api">
<h2>Design philosophy: high-level vs. low-level API<a class="headerlink" href="#design-philosophy-high-level-vs-low-level-api" title="Link to this heading">¶</a></h2>
<p>BLDFM exposes two tiers of API, each targeting a different use case.</p>
<dl class="simple">
<dt><strong>High-level API</strong> — <a class="reference internal" href="src.html#module-bldfm.interface" title="bldfm.interface"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.interface</span></code></a></dt><dd><p>The four <code class="docutils literal notranslate"><span class="pre">run_bldfm_*</span></code> functions accept a <a class="reference internal" href="src.html#bldfm.config_parser.BLDFMConfig" title="bldfm.config_parser.BLDFMConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BLDFMConfig</span></code></a>
object and return result dictionaries. Configuration objects carry every
parameter (domain, towers, meteorology, solver options), making runs
reproducible from a single YAML file. Use this tier for production science
workflows, batch runs, and the CLI.</p>
</dd>
<dt><strong>Low-level API</strong> — individual modules</dt><dd><p>The core functions <a class="reference internal" href="src.html#bldfm.pbl_model.vertical_profiles" title="bldfm.pbl_model.vertical_profiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">vertical_profiles()</span></code></a>,
<a class="reference internal" href="src.html#bldfm.solver.steady_state_transport_solver" title="bldfm.solver.steady_state_transport_solver"><code class="xref py py-func docutils literal notranslate"><span class="pre">steady_state_transport_solver()</span></code></a>,
<a class="reference internal" href="src.html#bldfm.utils.compute_wind_fields" title="bldfm.utils.compute_wind_fields"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_wind_fields()</span></code></a>, and
<a class="reference internal" href="src.html#bldfm.utils.ideal_source" title="bldfm.utils.ideal_source"><code class="xref py py-func docutils literal notranslate"><span class="pre">ideal_source()</span></code></a> can be called directly with plain
NumPy arrays and scalars. This gives full control over intermediate results
and is suited for custom parameter sweeps, debugging, or building new
wrappers. Note that <a class="reference internal" href="src.html#bldfm.pbl_model.vertical_profiles" title="bldfm.pbl_model.vertical_profiles"><code class="xref py py-func docutils literal notranslate"><span class="pre">vertical_profiles()</span></code></a> is
intentionally not re-exported in the top-level <code class="docutils literal notranslate"><span class="pre">__all__</span></code>; import it
explicitly from <a class="reference internal" href="src.html#module-bldfm.pbl_model" title="bldfm.pbl_model"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bldfm.pbl_model</span></code></a> when working at this level.</p>
</dd>
</dl>
<p><strong>Choosing a tier.</strong> Start with the high-level API. Drop to the low-level API
when you need to inspect or modify intermediate quantities (e.g. vertical
profiles), run the solver with non-standard inputs, or integrate BLDFM into a
larger modelling framework.</p>
</section>
<section id="api-reference">
<h2>API reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h2>
<p>For detailed information on functions and usage, refer to the <a class="reference internal" href="src.html#src"><span class="std std-ref">API Documentation</span></a>.</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="reference.html" title="Previous document">Quick reference</a>
        </li>
        <li>
          <a href="src.html" title="Next document">The <code class="docutils literal notranslate"><span class="pre">bldfm</span></code> package</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Mark Schlutow, Ray Chew, Mathias Göckede.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/overview.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>